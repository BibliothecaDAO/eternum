import BuildingCard from "../../../components/BuildingCard";
import { formatNumberWithCommas } from "@/utils/formatting";
import { CapacityConfig } from "@bibliothecadao/types";
import { ETERNUM_CONFIG } from "@/utils/config";

# ðŸª“ Buildings

## Standard vs. Simple

Blitz offers two building systems. Lords can switch between standard and simple building modes at any time by clicking
the toggle at the top of the construction tab.

![Simple Mode Production](/gifs/simple-mode.gif)

_Note: Some buildings only require labor to construct. Farms and Wood Mills have the same construction cost in both
standard and simple building modes._

### Standard Mode

This is the classic building experience. Construction requires a combination of labor and a particular set of resources
as building materials. Standard mode is more complex as it involves a greater variety and amount of materials in
storage, however it is far more efficient overall.

### Simple Mode

This mode allows players to utilize labor as the singular input for construction. Simple mode greatly improves
accessibility and simplifies gameplay overall, but is much less efficient in both time and materials.

## Placement & Population

### Placement

The construction tab can be accessed in the Local view. Buildings can be constructed on any buildable hex of a Realm,
provided the owner has the requisite materials and population capacity. Buildable hexes are defined by the upgrade level
(i.e. Settlement, City, Kingdom, or Empire) and are visible as hexes with patches of bare, prepared earth.

![Building Placement](/gifs/construction.gif)

### Population

**Population** is the total population used to construct the current buildings on a Realm, while the **population
capacity** is the maximum available population with which to construct buildings. Worker Huts can be built to increase
population capacity, while all other buildings require population capacity to be available in order to construct. Lords
must balance their construction to ensure there is enough population capacity available to construct their desired
production buildings.

## Building Types

### The Keep

All Realms start the game with a structure in the centre of the buildable hexes, known as the Keep. This structure
represents the central point of governance of the Realm, and facilitates key functions such as Realm upgrades and labor
production. This building cannot be destroyed and provides a baseline population capacity of 5.

<BuildingCard
  title="Keep"
  image="/images/buildings/construction/castleZero.png"
  buildingType={25}
  description={["Produces labor", "Provides a baseline population capacity of 5", "Cannot be constructed or destroyed"]}
/>

### Resource Buildings

There is a specific resource building for each of the 9 resources in Blitz, so Lords will require separate resource
buildings if they wish to produce more than one type of resource.

<div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fill, minmax(230px, 1fr))', gap: '0.75rem' }}>
<BuildingCard 
  title="Wood Mill" 
  image="/images/buildings/construction/lumber_mill.png" 
  buildingType={5} 
  description={[
    "Produces Wood resource",
    "Same construction cost in both simple and standard modes"
  ]}
/>

<BuildingCard
  title="Coal Mine"
  image="/images/buildings/construction/mine.png"
  buildingType={4}
  description={["Produces Coal resource"]}
/>

<BuildingCard
  title="Copper Smelter"
  image="/images/buildings/construction/forge.png"
  buildingType={6}
  description={["Produces Copper resource"]}
/>

<BuildingCard
  title="Ironwood Mill"
  image="/images/buildings/construction/lumber_mill.png"
  buildingType={7}
  description={["Produces Ironwood resource"]}
/>

<BuildingCard
  title="Cold Iron Foundry"
  image="/images/buildings/construction/forge.png"
  buildingType={13}
  description={["Produces Cold Iron resource"]}
/>

<BuildingCard
  title="Gold Mine"
  image="/images/buildings/construction/forge.png"
  buildingType={9}
  description={["Produces Gold resource"]}
/>

<BuildingCard
  title="Adamantine Mine"
  image="/images/buildings/construction/forge.png"
  buildingType={21}
  description={["Produces Adamantine resource"]}
/>

<BuildingCard
  title="Mithral Forge"
  image="/images/buildings/construction/forge.png"
  buildingType={11}
  description={["Produces Mithral resource"]}
/>

<BuildingCard
  title="Dragonhide Tannery"
  image="/images/buildings/construction/dragonhide.png"
  buildingType={24}
  description={[
    "Produces Dragonhide resource",
  ]}
/>
</div>

### Economic Buildings

These buildings define the utility of a Realm, including food production, donkey production, population capacity, and
storage capacity. All of these buildings can be constructed in either standard or simple mode, but have varying costs
and population requirements:

<div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fill, minmax(230px, 1fr))', gap: '0.75rem' }}>
<BuildingCard 
  title="Worker's Hut" 
  image="/images/buildings/construction/workers_hut.png" 
  buildingType={1} 
  description={[
    "Increases population capacity by 5",
  ]}
/>

<BuildingCard
  title="Storehouse"
  image="/images/buildings/construction/storehouse.png"
  buildingType={2}
  description={[
    "Increases storage capacity by {formatNumberWithCommas(ETERNUM_CONFIG().carryCapacityGram[CapacityConfig.Storehouse]/1000 )} kg",
  ]}
/>

<BuildingCard
  title="Market"
  image="/images/buildings/construction/market.png"
  buildingType={27}
  description={["Produces Donkeys for transportation of materials"]}
/>

<BuildingCard
  title="Farm"
  image="/images/buildings/construction/farm.png"
  buildingType={37}
  description={[
    "Produces Wheat (food)",
    "Same construction cost in both simple and standard modes",
  ]}
/>
</div>

### Military Buildings

Military buildings are essential for developing armies to defend territories and project might. There are three 'tiers'
of each of the three troop types, but a different building is required to produce each troop tier. As such, there are a
total of 9 military buildings in the game.

Note: Only T1 troop buildings can be constructed in both standard and simple mode. T2 and T3 military buildings are only
available for construction in standard mode.

<div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fill, minmax(230px, 1fr))', gap: '0.75rem' }}>
<BuildingCard 
  title="Barracks (T1)" 
  image="/images/buildings/construction/barracks.png" 
  buildingType={28} 
  description={[
    "Produces T1 Knight units",
    "Available in both simple and standard building modes"
  ]}
/>

<BuildingCard
  title="Barracks (T2)"
  image="/images/buildings/construction/barracks.png"
  buildingType={29}
  description={["Produces T2 Knight units", "Only available in standard building mode"]}
/>

<BuildingCard
  title="Barracks (T3)"
  image="/images/buildings/construction/barracks.png"
  buildingType={30}
  description={["Produces T3 Knight units", "Only available in standard building mode"]}
/>

<BuildingCard
  title="Archery Range (T1)"
  image="/images/buildings/construction/archery.png"
  buildingType={31}
  description={["Produces T1 Crossbowman units", "Available in both simple and standard building modes"]}
/>

<BuildingCard
  title="Archery Range (T2)"
  image="/images/buildings/construction/archery.png"
  buildingType={32}
  description={["Produces T2 Crossbowman units", "Only available in standard building mode"]}
/>

<BuildingCard
  title="Archery Range (T3)"
  image="/images/buildings/construction/archery.png"
  buildingType={33}
  description={["Produces T3 Crossbowman units", "Only available in standard building mode"]}
/>

<BuildingCard
  title="Stables (T1)"
  image="/images/buildings/construction/stable.png"
  buildingType={34}
  description={["Produces T1 Paladin units", "Available in both simple and standard building modes"]}
/>

<BuildingCard
  title="Stables (T2)"
  image="/images/buildings/construction/stable.png"
  buildingType={35}
  description={["Produces T2 Paladin units", "Only available in standard building mode"]}
/>

<BuildingCard 
  title="Stables (T3)" 
  image="/images/buildings/construction/stable.png" 
  buildingType={36} 
  description={[
    "Produces T3 Paladin units",
    "Only available in standard building mode"
  ]}
/>
</div>

### Same Building Cost Increase

Building multiple buildings of the same type on a single Realm will cost progressively more each time. The cost increase
is calculated using the following formula:

```
Cost = Base Cost + (Base Cost Ã— 0.1 Ã— (N-1)Â²)
```

Where:

- **Base Cost** is the initial cost of the building (from the tables above)
- **N** is the number of the same buildings already constructed

For example, if you build a second building of the same type (N=2), the cost will be:

```
Cost = Base Cost + (Base Cost Ã— 0.1 Ã— (2-1)Â²)
     = Base Cost + (Base Cost Ã— 0.1 Ã— 1)
     = Base Cost Ã— 1.1
```

Note: Buildings need to be exactly the same type for this rule to apply. For example, building a Coal Mine after a Wood
Mill (both being resource buildings) would not be subject to this cost increase.
