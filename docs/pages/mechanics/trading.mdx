import { DONKEY_SPEED } from "@bibliothecadao/eternum";
import { CapacityConfigCategory, EternumGlobalConfig } from "@bibliothecadao/eternum";

# ü´è Trading System

## Order Book

- Trade resources with other players
- All trades require donkeys for transport
- Resources have weight that affects transport capacity
- Monitor market prices for optimal trading

## Automated Market Maker (AMM)

### Swaps

The AMM enables players to swap resources for **$LORDS** and vice versa. Exchange rates are influenced by liquidity
pools.

### Liquidity Pools

Players can provide liquidity by depositing resources and **$LORDS** into pools. This earns trading fees proportional to
your share and helps maintain a stable trading environment, increasing overall market efficiency.

### Liquidity Provision Rules

- **Realm Ownership Requirement**: You must own at least one realm to provide or withdraw liquidity from the AMM

- **Liquidity Addition**: Adding liquidity is instant and does not require donkeys or transport time

- **Liquidity Removal**: Removing liquidity requires donkeys and transport time (depending on realm distance to the
  bank)

- **Account-Based Liquidity**: Your provided liquidity is tied to your player account, not to any specific realm

- **Flexible Withdrawal**: You can withdraw liquidity using any realm you own, regardless of which realm was used to
  provide it

- **Realm Selection**: When withdrawing liquidity, you can choose which realm receives the withdrawn resources

> ‚ö†Ô∏è **Important**: Even though liquidity is tracked at the account level, you must maintain ownership of at least one
> realm to manage your liquidity positions

## Transport <img src="/resources/249.png" alt="Donkey" width="200" className="float-right" />

Donkeys are essential for all resource transfers. Each donkey can carry up to
**{(EternumGlobalConfig.carryCapacityGram[CapacityConfigCategory.Donkey] / 1000).toLocaleString()} kg**, and transport
time depends on the distance to its destination. It's important to consider transport costs in your trade calculations.
Ensure your realm has the necessary resources for transportation.

### Transporting Resources

To bridge resources, visit the [Empires Bridge](https://empire.realms.world/trade).

- **Sending Resource**s: When you want to send resources (like **$LORDS**) to another realm, the bridge calculates the
  distance and travel time based on the coordinates of your realm and the central bank. The transport time depends on
  the distance and is calculated as {DONKEY_SPEED} seconds per kilometer.
- **Withdrawing Resources**: To bridge resources out of the game, you must first travel from your realm to the central
  bank. This process is not instant, resources must physically "move" to the bank. You can bridge out here
  <a href="https://empire.realms.world/">here</a>.

## üè¶ Central Bank <img src="/buildings/bank.png" alt="Bank" width="300" className="float-right" />

The Central Bank is a neutral structure, located at the center of the map, that controls the AMM and receives a part of
its fees. The central bank acts as the hub for all bridging activities. Whether you‚Äôre sending resources to another
realm or withdrawing them, everything must pass through the central bank first.

Anyone can claim it for themselves, but be wary, as it is protected by a significant defensive force.

> ‚ö†Ô∏è **Note:** When the Bank is being attacked, the AMM will be **locked** until the battle has ended.

**Ownership Benefits:**

- Owner collects AMM trading fees, providing a significant source of passive income.
- The bank can be attacked and claimed by other players, making it a strategic target.

## Trading Tips

> üí° **Strategy**
>
> - Regularly monitor market prices
> - Factor in transport costs when calculating trade profits
> - Watch liquidity levels for better exchange rates
> - Ensure you have sufficient donkey capacity for efficient trading
